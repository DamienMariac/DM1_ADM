rm(list = ls())
tab <- read.csv("C:/Users/damie/Desktop/MASTER/ADM/tp/tp1/Datagenus.csv", sep = ";")
data <- tab[1 :1000,]
species_columns <- grep("gen", colnames(data), value = TRUE)
density_data <- data[species_columns] / data$surface
W <- diag(1/1000, 1000, 1000)
I_n <- rep(1, 1000)
Q <- as.matrix(density_data)
x_b <- t(Q) %*% W %*% I_n # moyenne (par projection)
x_c <- Q - I_n %*% t(x_b) #x centré (par projection)
vec_norm <- sqrt(diag(t(x_c) %*% W %*% x_c))
x_cr <- sweep(x_c, 2, vec_norm, FUN = "/")
tableau_cr <- as.data.frame(x_cr)
bar <- t(x_cr) %*% W %*% I_n
barycentre <- t(bar)
print(barycentre)
inertie_totale <- sum(diag(t(x_cr) %*% W %*% x_cr)) #inertie
print(inertie_totale)
print(tableau_cr)
forest_types <- unique(data$forest)
n_types <- length(forest_types)
poids <- numeric(n_types)
barycentres_types <- matrix(0, n_types, length(species_columns))
for (i in 1:n_types) {
parcelles_type_i <- which(data$forest == forest_types[i])
n_i <- length(parcelles_type_i)
poids[i] <- n_i / 1000
W_i <- diag(1/n_i, n_i, n_i)
I_i <- rep(1, n_i)
Q_i <- as.matrix(x_cr[parcelles_type_i, ])
x_b_i <- t(Q_i) %*% W_i %*% I_i
barycentres_types[i, ] <- t(x_b_i)
}
normes_carre_barycentres <- rowSums(barycentres_types^2)
inertie_inter_types <- sum(poids * normes_carre_barycentres)
print(inertie_inter_types)
R2 <- inertie_inter_types / inertie_totale
print(R2)
forest_types <- unique(data$forest)
n_types <- length(forest_types)
R2_variables <- numeric(length(species_columns))
for (j in 1:length(species_columns)) {
variance_totale_j <- sum((x_cr[, j] - mean(x_cr[, j]))^2) / 1000
variance_inter_j <- 0
for (i in 1:n_types) {
parcelles_type_i <- which(data$forest == forest_types[i])
n_i <- length(parcelles_type_i)
poids_i <- n_i / 1000
W_i <- diag(1/n_i, n_i, n_i)
I_i <- rep(1, n_i)
Q_i <- as.matrix(x_cr[parcelles_type_i, j])
barycentre_i <- t(Q_i) %*% W_i %*% I_i
variance_inter_j <- variance_inter_j + poids_i * as.numeric(barycentre_i)^2
}
R2_variables[j] <- variance_inter_j / variance_totale_j
}
print(R2_variables)
densite_max <- species_columns[which.max(R2_variables)]
densite_min <- species_columns[which.min(R2_variables)]
cat("Densité la plus liée au type :", densite_max, "avec R² =", max(R2_variables), "\n")
cat("Densité la moins liée au type :", densite_min, "avec R² =", min(R2_variables), "\n")
R2_global <- sum(R2_variables) / length(R2_variables)
print(R2_global)
R2_partition <- sum(poids * rowSums(barycentres_types^2)) / 27
print(R2_partition)
cat("Densité la plus liée au type :", densite_max, "avec R² =", max(R2_variables), "\n")
cat("Densité la moins liée au type :", densite_min, "avec R² =", min(R2_variables), "\n")
rm(list = ls())
tab <- read.csv("./Datagenus.csv", sep = ";")
data <- tab[1 :1000,]
species_columns <- grep("gen", colnames(data), value = TRUE)
density_data <- data[species_columns] / data$surface
W <- diag(1/1000, 1000, 1000)
I_n <- rep(1, 1000)
Q <- as.matrix(density_data)
x_b <- t(Q) %*% W %*% I_n # moyenne (par projection)
x_c <- Q - I_n %*% t(x_b)
vec_norm <- sqrt(diag(t(x_c) %*% W %*% x_c))
x_cr <- sweep(x_c, 2, vec_norm, FUN = "/")
tableau_cr <- as.data.frame(x_cr)
bar <- t(x_cr) %*% W %*% I_n
barycentre <- t(bar)
print(barycentre)
rm(list = ls())
tab <- read.csv("./Datagenus.csv", sep = ";")
rm(list = ls())
tab <- read.csv("C:/Users/damie/Desktop/MASTER/ADM/tp/tp1/Datagenus", sep = ";")
rm(list = ls())
tab <- read.csv("C:/Users/damie/Desktop/MASTER/ADM/tp/tp1/Datagenus.csv", sep = ";")
data <- tab[1 :1000,]
species_columns <- grep("gen", colnames(data), value = TRUE)
density_data <- data[species_columns] / data$surface
W <- diag(1/1000, 1000, 1000)
I_n <- rep(1, 1000)
Q <- as.matrix(density_data)
x_b <- t(Q) %*% W %*% I_n # moyenne (par projection)
x_c <- Q - I_n %*% t(x_b)
vec_norm <- sqrt(diag(t(x_c) %*% W %*% x_c))
x_cr <- sweep(x_c, 2, vec_norm, FUN = "/")
tableau_cr <- as.data.frame(x_cr)
bar <- t(x_cr) %*% W %*% I_n
barycentre <- t(bar)
print(barycentre)
inertie_totale <- sum(diag(t(x_cr) %*% W %*% x_cr)) #inertie
print(inertie_totale)
print(tableau_cr)
forest_types <- unique(data$forest)
n_types <- length(forest_types)
poids <- numeric(n_types)
barycentres_types <- matrix(0, n_types, length(species_columns))
for (i in 1:n_types) {
parcelles_type_i <- which(data$forest == forest_types[i])
n_i <- length(parcelles_type_i)
poids[i] <- n_i / 1000
W_i <- diag(1/n_i, n_i, n_i)
I_i <- rep(1, n_i)
Q_i <- as.matrix(x_cr[parcelles_type_i, ])
x_b_i <- t(Q_i) %*% W_i %*% I_i
barycentres_types[i, ] <- t(x_b_i)
}
normes_carre_barycentres <- rowSums(barycentres_types^2)
inertie_inter_types <- sum(poids * normes_carre_barycentres)
print(inertie_inter_types)
R2 <- inertie_inter_types / inertie_totale
print(R2)
forest_types <- unique(data$forest)
n_types <- length(forest_types)
R2_variables <- numeric(length(species_columns))
for (j in 1:length(species_columns)) {
variance_totale_j <- sum((x_cr[, j] - mean(x_cr[, j]))^2) / 1000
variance_inter_j <- 0
for (i in 1:n_types) {
parcelles_type_i <- which(data$forest == forest_types[i])
n_i <- length(parcelles_type_i)
poids_i <- n_i / 1000
W_i <- diag(1/n_i, n_i, n_i)
I_i <- rep(1, n_i)
Q_i <- as.matrix(x_cr[parcelles_type_i, j])
barycentre_i <- t(Q_i) %*% W_i %*% I_i
variance_inter_j <- variance_inter_j + poids_i * as.numeric(barycentre_i)^2
}
R2_variables[j] <- variance_inter_j / variance_totale_j
}
print(R2_variables)
densite_max <- species_columns[which.max(R2_variables)]
densite_min <- species_columns[which.min(R2_variables)]
print(densite_max)
print(densite_min)
R2_global <- sum(R2_variables) / length(R2_variables)
print(R2_global)
R2_partition <- sum(poids * rowSums(barycentres_types^2)) / 27
print(R2_partition)
